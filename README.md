# 🏥 手術分析ダッシュボード v2.0

入退院分析ダッシュボードと同様のモダンなUI/UXを採用した手術件数分析アプリケーション

## ✨ 新機能・改善点

### 🎨 ダッシュボード形式のUI
- **KPIカード**: 重要指標を視覚的に表示
- **インタラクティブフィルター**: リアルタイムでデータを絞り込み
- **モダンデザイン**: グラデーション、アニメーション効果
- **レスポンシブ**: モバイル・タブレット対応

### 📊 強化された分析機能
- **リアルタイム更新**: 自動データ更新機能
- **統合ダッシュボード**: 全指標を一画面で確認
- **ドリルダウン分析**: 詳細データへの段階的アクセス
- **比較分析**: 前期比、目標比の可視化

### 🔧 技術的改善
- **パフォーマンス最適化**: キャッシュ機能、並列処理
- **エラーハンドリング**: 堅牢なエラー処理
- **モジュール化**: コンポーネント分離による保守性向上

## 🚀 クイックスタート

### 1. 環境設定
```bash
# 必要なライブラリをインストール
pip install streamlit pandas plotly numpy pytz

# アプリケーションを起動
streamlit run app_dashboard.py
```

### 2. データアップロード
1. **基礎データ**: 手術実績CSV（必須）
2. **目標データ**: 診療科別目標CSV（任意）
3. **追加データ**: 最新データCSV（任意）

### 3. ダッシュボード利用
- 左サイドバーからメニュー選択
- フィルターでデータ絞り込み
- KPIカードで重要指標確認
- グラフで詳細分析

## 📋 データ形式

### 基礎データ（手術実績）
```csv
手術実施日,麻酔種別,実施診療科,実施術者,入室時刻,退室時刻
2024-01-01,全身麻酔（20分以上）,外科,田中医師,09:00,11:30
2024-01-01,全身麻酔（20分以上）,内科,佐藤医師,13:00,15:00
```

### 目標データ
```csv
診療科,目標
外科,10
内科,8
小児科,5
```

## 🎛️ ダッシュボード機能

### メインダッシュボード
- **KPI概要**: 総手術件数、平均、達成率
- **トレンド分析**: 時系列推移グラフ
- **診療科別内訳**: 構成比、ランキング
- **パフォーマンス指標**: 目標達成状況

### 分析メニュー
1. **🏠 ダッシュボード**: 統合ビュー
2. **📤 データアップロード**: ファイル管理
3. **🏥 病院全体分析**: 全体統計
4. **🩺 診療科別分析**: 個別診療科詳細
5. **🏆 診療科ランキング**: 比較分析
6. **👨‍⚕️ 術者分析**: 術者別統計
7. **🔮 将来予測**: AI予測分析

## 🎨 カスタマイズ

### カラーテーマ変更
```python
# dashboard_styles.py内で設定
DASHBOARD_COLORS = {
    'primary': '#667eea',      # メインカラー
    'secondary': '#764ba2',    # セカンダリカラー
    'success': '#2ea043',      # 成功色
    'warning': '#ff7f0e',      # 警告色
    'danger': '#d62728',       # 危険色
}
```

### KPIカード追加
```python
# dashboard_components.py内で実装
def create_custom_kpi_card(icon, title, value, change=None):
    # カスタムKPIカードの実装
    pass
```

## 📈 新しいグラフスタイル

### 統一されたデザイン
- **フォント**: Segoe UI
- **カラーパレット**: 一貫したブランドカラー
- **アニメーション**: スムーズなトランジション
- **レスポンシブ**: 画面サイズ自動調整

### インタラクティブ要素
- **ホバー効果**: 詳細情報表示
- **ズーム機能**: データ拡大表示
- **フィルタリング**: リアルタイム絞り込み
- **ドリルダウン**: 階層的データ探索

## 🔧 設定とパフォーマンス

### キャッシュ設定
```python
@st.cache_data(ttl=3600)  # 1時間キャッシュ
def analyze_data(df):
    # データ分析処理
    pass
```

### 並列処理
```python
import concurrent.futures

# 複数処理を並列実行
with concurrent.futures.ThreadPoolExecutor() as executor:
    futures = [executor.submit(process_data, chunk) for chunk in chunks]
    results = [future.result() for future in futures]
```

## 📱 レスポンシブデザイン

### モバイル対応
- **最適化されたレイアウト**: 小画面での見やすさ
- **タッチフレンドリー**: タップ操作対応
- **軽量化**: 高速読み込み

### タブレット対応
- **中間レイアウト**: タブレットサイズ最適化
- **ジェスチャー対応**: スワイプ、ピンチ操作

## 🚨 トラブルシューティング

### よくある問題

#### データが表示されない
```
原因: CSVファイルのエンコーディング
解決: UTF-8またはShift-JISで保存
```

#### グラフが表示されない
```
原因: ライブラリのバージョン不適合
解決: pip install --upgrade plotly streamlit
```

#### パフォーマンスが遅い
```
原因: 大量データ処理
解決: フィルター機能を活用、データを分割
```

### エラーログ確認
```bash
# Streamlitログ確認
streamlit run app_dashboard.py --logger.level=debug
```

## 🔄 アップデート履歴

### v2.0 (2024-12-19)
- ✨ ダッシュボード形式UI導入
- 🎨 モダンデザイン適用
- ⚡ パフォーマンス最適化
- 📱 レスポンシブ対応

### v1.5 (2024-11-15)
- 🔮 将来予測機能追加
- 👨‍⚕️ 術者分析機能追加
- 📊 PDF出力機能強化

### v1.0 (2024-10-01)
- 🏥 基本的な手術件数分析機能
- 📈 週次・月次・四半期分析
- 🏆 診療科ランキング

## 🤝 貢献・フィードバック

### 機能リクエスト
- GitHub Issuesでご報告ください
- 具体的な利用シーンを記載

### バグレポート
- 再現手順を明確に記載
- エラーログを添付

### 開発への参加
- フォーク・プルリクエスト歓迎
- コーディング規約に従って実装

## 📄 ライセンス

MIT License - 詳細は LICENSE ファイルを参照

## 🙏 謝辞

- Streamlit コミュニティ
- Plotly 開発チーム
- オープンソースコントリビューター

---

**🏥 手術分析ダッシュボード v2.0**  
© 2024 Medical Information Management Department